# MATE Manual
### Описание
**Methods of Archiving, Automation and Assembly for Typical Exercises** (*MAAATE*/***MATE***) - "*Методы архивирования, автоматизации и сборки для типовых упражнений*" представляют из себя набор скриптоподобный решений, базирующихся в оболочке `UNIX` систем на удаленном сервере. Основной набор решений интерпретируется на языке `BASH`. Основной целью *MATE* является удовлетворение различных запросов на упрощение работы с типовыми заданиями.

### Предподготовка
Перед началом работы c *MATE* рекомендую ознакомиться с основами использования `UNIX` систем ([наиболее краткая статья](https://habr.com/ru/post/267825/)).
#### Выбор OC
Наборы программного обеспечения для подключения к серверу присутствуют на всех популярных OC (*Windows*/*Mac*/*Linux*), но для обеспечения наибольшей совместимости и упрощения опыта пользования рекомендуется использовать системы *Linux*.  
### Подключение
Подключение к серверу может быть осуществлено двумя способами:

1) Подключение по протоколу `SSH` (Для удаленного доступа к системе: *просмотра*, *записи* и *исполнения*)
2) Подключение по протоколу `SFTP` (Только для *просмотра* и *копирования* файлов)

##### `SSH`
Подключение по протоколу `SSH` ***обеспечивает*** полный доступ ко всем функциям *MATE*. И осуществляется через ***ssh-клиенты*** (*Консольные*: `ssh`(Windows/Linux)(*рекомендуется*) *Графические*: `PuTTY`(Windows/Linux)). 
Для каждого пользователя создается отдельная учетная запись в системе. Для создания учетной записи пользователь должен предоставить следующие данные:

* **Логин** (формируется транслитерацией настоящего имени пользователя, в зависимости от уже созданных)
* **Студенческая группа пользователя**
* **Информация о пользователе** (ФИ, адрес эл. почты и прочее, по желанию пользователя)
* **Публичная часть SSH-ключа***

###### *Генерация SSH-ключа в Windows:
Убедитесь, что в вашей системе установлен ssh-клиент, при вводе команды `ssh` в командной строке должен быть вывод примерно такого содержания:
```
> ssh
usage: ssh [-46AaCfGgKkMNnqsTtVvXxYy] [-b bind_address] [-c cipher_spec]
[-D [bind_address:]port] [-E log_file] [-e escape_char]
[-F configfile] [-I pkcs11] [-i identity_file]
[-J [user@]host[:port]] [-L address] [-l login_name] [-m mac_spec]
[-O ctl_cmd] [-o option] [-p port] [-Q query_option] [-R address]
[-S ctl_path] [-W host:port] [-w local_tun[:remote_tun]]
destination [command]
```
Далее введите команду `ssh-keygen` и сгенерируйте ключ. Все опции генерации можно пропустить (нажатием `Enter`). При успешной генерации, по пути, указанном при генерации, должен находиться файл *id_rsa.pub* именно он является публичной частью ключа.

###### *Генерация SSH-ключа в Linux:
Убедитесь, что в вашей системе установлен ssh-клиент, при вводе команды `which ssh` в командной строке должен быть вывод примерно такого содержания:
```
> which ssh
/usr/bin/ssh
```
Далее введите команду `ssh-keygen` и сгенерируйте ключ. Все опции генерации можно пропустить (нажатием `Enter`). При успешной генерации, по пути, указанном при генерации (обычно */home/$USER/.ssh/*), должен находиться файл *id_rsa.pub* именно он является публичной частью ключа.

###### Подключение к серверу
После предоставления необходимой информации и получения IP-адреса сервера вы можете подключаться к серверу с помощью команды `ssh [логин]@[IP-адрес]`. Вход осуществляется по заранее сгенерированному ключу, если при генерации ключа был указан другой путь, дополнительно укажите путь к нему.
Если все действия были выполнены верно, вы увидите приветственные сообщения и строку приглашения BASH

##### `SFTP`
Подключение по протоколу `SFTP` ***не обеспечивает*** полного доступа ко всем функциям *MATE*, а только возможность просматривать и копировать файлы. Подключение осуществляется через ***FTP-клиенты*** (*Графические*: `FileZilla`(Windows/Linux)(*рекомендуется*), `Nautilus`(Linux), `Cyberduck`(Windows). 
Для входа нужен логин, пароль и IP-адрес сервера

###### Подключение к серверу
После получения логин, пароль и IP-адреса сервера вы можете подключаться к серверу с помощью выбранного вами клиента.

### Основы работы 
##### Теоретическая часть
Принцип работы *MATE* основывается на ***2 основных идеях***:
***Идея (№1)*** предполагает то, что минимальной единицей работы является задание, в последствии формируя следующую структуру элементов:
```
- Группы (набор курсов)
    - Курсы (набор работ)
        - Работы (набор вариантов или заданий, если вариант один)
            - Варианты (наборы заданий)
                - Задания (минимальная единица структуры)
```
***Идея (№2)*** предполагает то, что к любому ***типичному заданию*** можно дать хотя бы одно ***типичное решение***.

*Базирование на данных *идеях* позволяет определить следующие методы архивирования, автоматизации и сборки для типовых упражнений, реализованные в MATE:*
* Архивация
    1) Создание архива, отражающего структуру элементов идеи (№1) 
    2) Возможность постепенного добавления любого *элемента* идеи (№1) в архив
    3) Возможность каждого пользователя предложить *уникальное решение* и последующая архивация этого *решения*
    4) Структуризация описания элементов
* Автоматизация
    1) Подбор и фильтрация *элементов* идеи (№1) в зависимости от заданных пользователем параметров
    2) Подбор и фильтрация *решений* в зависимости от заданных пользователем параметров
    3) Препятствие нарушению структуризации описания элементов со стороны пользователей
* Сборка
    1) Создание конечных решений на основе указанных пользователем *параметров* (***паттернов***)
    2) Форматирование выбранного пользователем решения

##### Практическая часть
Основная функциональность методов *MATE* реализуется через программу `bds <режим> [дополнительные параметры]`.
`bds` имеет 2 режима:
1) `add` - режим создания и расширения основных *структур* и *элементов* архива *MATE* (реализует п.2 методов архивации)
2) `slv` - режим решения *типичных заданий* (реализует п.2 методов автоматизации и п.1, п.2 методов сборки)

Программа `bds` может работать как в интерактивном режиме, так и принимать дополнительные параметры следующим после режима аргументом.
Пример: `bds slv -g "MSAIS-24-1" "1.5:2.3"`




### Ход действий для отдельной работы
1) ***Публикация работы*** (Выполняется *один раз, для всех пользователей*)
    1) Получение работы и входящих в нее заданий
    2) Добавление работы и входящих в нее заданий в архив (`bds add`)
2) ***Решение работы*** `bds slv` (Выполняется *неограниченное количество раз, каждым отдельным пользователем лично для себя*)
    1) Решение задания
        * Предложение собственного уникального решения
        * Использование ранее предложенного решения
    2) Сборка
        1) Использование инструментов форматирования
        2) Cборка по заданным параметрам (*паттернам*)
3) ***Копирование конечного решения***

##### Подробное описание каждого шага
1\. Публикация работы выполняется один раз, для всех пользователей, далее она становится доступна всем пользователям (даже из других групп, но только для решения).

1\.1\. Получение работы предполагает владение точным описанием ее структуры и заданий, входящих в нее. Желательно в цифровой текстовой форме, в иных случаях рекомендуется преобразовать ее в таковую (например, с помощью Image to Text Converter, для растровых изображений).

1\.2\. При помощи команды `bds add` вы можете добавлять любой из элементов *идеи (№1)* в пределах своей группы. Программа может быть *преждевременно* остановлена, по средствам передачи сигнала прерывания (`Ctrl+C`) после нужного шага. Описание задания происходит в текстовом редакторе **nano**. Если задание уже существует, оно *может быть перезаписано*.

2\. Решение работы выполняется неограниченное количество раз, каждым отдельным пользователем лично для себя, при помощи команды `bds slv`. *Любой пользователь может решать работы любой группы*.

2\.1\. После выбора задания, программой `bds slv` будет предложено 2 варианта:

*ИЛИ* \- Предложение собственного уникального решения (команда `s`). Если вы уверены, что нашли правильное и неизвестное, до этого времени, уникальное решение задания, вы можете предложить его от вашего лица, оно будет доступно всем пользователям (*включая пользователей из других групп*). Процесс создания решения происходит в текстовом редакторе **nano**, перед этим вам будет предложено выбрать язык программирования, на котором реализовано решение, *выбор языка будет играть важную роль в процессе генерации*. После успешного создания решения оно хранится по пути: /home/$USER/solutions/{группа}/{курс}/{работа}/{вариант}/{название решения}.

*ИЛИ* \- Использование ранее предложенного решения (команда `h`). Вы можете использовать ранее предложенное другим пользователем (*включая пользователей из других групп*) решение выбранного задания.
По окончанию этого этапа (*любым способом*) у вас будет выбрано определенное решение.

2\.2\. Процесс сборки состоит из 2 этапов:

2\.2\.1\. Форматирование входных данных. На данный момент реализована только beautifi-ризация кода, определение языка происходит в зависимости от указанного при создании решения расширения. При желании beautifi-ризацию можно отключить (команда `s`).

2\.2\.2\. Cборка по заданным параметрам (*паттерну*) происходит на основе выбранного паттерна. Используемый по умолчанию паттерн можно сменить (команда `p`) на любой паттерн любого пользователя.

3\. Конечным решением называется решение все процессы сборки и хранится по пути: /home/$USER/generated/{группа}/{курс}/{работа}/{вариант}/{название решения}. По окончанию 15 дней, с момента его создания, оно будет удалено 1 или 15 числа месяца. _Будет удален **только сгенерированный файл**, решение на основе которого он был сгенерирован **не удаляется**_. Далее конечное решение может быть скопировано прямо из терминала, с помощью команды `cat <путь к решению>` или программы `scp`, с локального компьютера.
